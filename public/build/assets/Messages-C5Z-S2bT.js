import{a as z,r as a,u as g,c as G,j as e,H,b as C}from"./app-DJvBc1fd.js";import{A as W,M as B}from"./AuthenticatedLayout-G_xV6EWj.js";import{M as R}from"./Modal-BOQV4GSg.js";import{P as M}from"./PrimaryButton-8Ypz53Vl.js";import{T as L,I as V}from"./TextInput-BrVaYbqk.js";import{I as v}from"./InputLabel-C34Ofn75.js";import{P as I,X as O}from"./x-BdkA4mvY.js";import{c as o}from"./createLucideIcon-C5DVBl7q.js";import{S as j}from"./search-Cs1L7SjW.js";import{P as X}from"./phone-ubK5RJ3A.js";import{S as J}from"./send-CMo0QTkE.js";import{L as K}from"./lock-cPvXnzwY.js";import{U as Q}from"./user-JxsXeZjU.js";import"./star-HWWjFtno.js";import"./transition-DWpDkJhl.js";const Y=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Z=o("arrow-left",Y);const ee=[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]],se=o("check-check",ee);const te=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],$=o("ellipsis-vertical",te);const ae=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],re=o("mic",ae);const le=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],ce=o("smile",le);const oe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ie=o("users",oe);const ne=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],de=o("video",ne),y=({src:d,alt:h,size:x="h-12 w-12"})=>e.jsx("div",{className:`${x} overflow-hidden rounded-full bg-gray-200 dark:bg-gray-700 flex-shrink-0`,children:e.jsx("img",{src:d,alt:h,className:"h-full w-full object-cover"})});function Ce({conversations:d=[],selectedConversation:h=null,messages:x=[],people:u=[]}){const p=z().props.auth.user,[i,N]=a.useState(x),[f,A]=a.useState(""),[D,m]=a.useState(!1),[b,w]=a.useState("individual"),k=a.useRef(null),t=h?.id||null;a.useMemo(()=>{const s=f.trim().toLowerCase();return s?u.filter(l=>(l.name||"").toLowerCase().includes(s)):u},[u,f]);const n=g({user_id:"",membership_number:""}),c=g({name:"",description:""}),r=g({body:""});a.useEffect(()=>{N(x)},[x,t]),a.useEffect(()=>{if(!t)return;const s=setInterval(async()=>{try{const l=i.length?i[i.length-1].id:0,S=(await G.get(route("messages.poll",t),{params:{after_id:l}}))?.data?.messages||[];S.length&&N(U=>[...U,...S])}catch{}},3e3);return()=>clearInterval(s)},[t,i]),a.useEffect(()=>{const s=k.current;s&&(s.scrollTop=s.scrollHeight)},[i,t]);const E=s=>{C.get(route("messages"),{conversation:s},{preserveScroll:!0,preserveState:!0})},F=s=>{s.preventDefault(),n.post(route("messages.start"),{preserveScroll:!0,onSuccess:()=>{m(!1),n.reset()}})},P=s=>{s.preventDefault(),console.log("Creating group:",c.data),m(!1),c.reset()},T=s=>{s.preventDefault(),!(!t||!r.data.body.trim())&&(r.data.body,r.post(route("messages.store",t),{preserveScroll:!0,onSuccess:()=>{r.reset("body")}}))},q=()=>{C.get(route("messages"),{},{preserveState:!1})},_=d.find(s=>s.id===t);return e.jsxs(W,{header:e.jsx("div",{className:"hidden",children:"Messages"}),children:[e.jsx(H,{title:"Messages"}),e.jsxs("div",{className:"-mx-4 -my-6 flex h-[calc(100vh-72px)] bg-[#111b21] text-[#e9edef] sm:-mx-6 lg:-mx-8 overflow-hidden relative",children:[e.jsxs("div",{className:`${t?"hidden sm:flex":"flex"} w-full flex-col border-r border-[#222d34] sm:w-[350px] lg:w-[400px]`,children:[e.jsxs("div",{className:"flex items-center justify-between bg-[#202c33] px-4 py-3 h-[60px] flex-shrink-0",children:[e.jsx(y,{src:p?.avatar_url,alt:p?.name,size:"h-10 w-10"}),e.jsxs("div",{className:"flex items-center gap-5 text-[#aebac1]",children:[e.jsx(I,{className:"h-6 w-6 cursor-pointer hover:text-white transition-colors",onClick:()=>m(!0)}),e.jsx($,{className:"h-6 w-6 cursor-pointer hover:text-white transition-colors"})]})]}),e.jsx("div",{className:"bg-[#111b21] p-2 flex-shrink-0",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx(j,{className:"h-4 w-4 text-[#8696a0]"})}),e.jsx("input",{value:f,onChange:s=>A(s.target.value),placeholder:"Search or start a new chat",className:"w-full rounded-lg border-none bg-[#202c33] py-1.5 pl-12 pr-3 text-sm text-[#d1d7db] placeholder-[#8696a0] focus:ring-0"})]})}),e.jsx("div",{className:"flex gap-2 bg-[#111b21] px-3 py-2 flex-shrink-0",children:["All","Unread","Favorites","Groups"].map(s=>e.jsx("button",{className:"rounded-full bg-[#202c33] px-3 py-1 text-xs font-medium text-[#8696a0] hover:bg-[#2a3942]",children:s},s))}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:d.length>0?d.map(s=>e.jsxs("button",{type:"button",onClick:()=>E(s.id),className:"flex w-full items-center gap-3 px-3 py-3 border-b border-[#222d34] transition "+(s.id===t?"bg-[#2a3942]":"hover:bg-[#202c33]"),children:[e.jsx(y,{src:s.other_user?.avatar_url,alt:s.other_user?.name}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"truncate text-[17px] text-[#e9edef] font-medium",children:s.other_user?.name}),e.jsx("div",{className:"text-xs text-[#8696a0]",children:s.last_message?.created_at?new Date(s.last_message.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""})]}),e.jsx("div",{className:"truncate text-sm text-[#8696a0] mt-0.5",children:s.last_message?.body||"Start chatting..."})]})]},s.id)):e.jsx("div",{className:"p-10 text-center text-sm text-[#8696a0]",children:"No conversations yet. Click + to start one."})})]}),e.jsx("div",{className:`${t?"flex":"hidden sm:flex"} flex-1 flex-col h-full overflow-hidden`,children:t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between bg-[#202c33] px-4 py-3 shadow-sm h-[60px] flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("button",{onClick:q,className:"sm:hidden p-1 -ml-1 text-[#aebac1]",children:e.jsx(Z,{className:"h-6 w-6"})}),e.jsx(y,{src:_?.other_user?.avatar_url,alt:"User",size:"h-10 w-10"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-sm font-medium text-[#e9edef] truncate",children:_?.other_user?.name}),e.jsx("div",{className:"text-xs text-[#8696a0]",children:"online"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 sm:gap-6 text-[#aebac1]",children:[e.jsxs("div",{className:"hidden lg:flex items-center gap-1 rounded-full border border-[#3b4a54] px-3 py-1 text-xs",children:[e.jsx(de,{className:"h-4 w-4"}),e.jsx(X,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-1 border-l border-[#3b4a54] pl-2",children:"Call"})]}),e.jsx(j,{className:"h-5 w-5 cursor-pointer hover:text-white"}),e.jsx($,{className:"h-5 w-5 cursor-pointer hover:text-white"})]})]}),e.jsx("div",{ref:k,className:"relative flex-1 overflow-y-auto px-4 sm:px-10 py-4 custom-scrollbar",style:{backgroundColor:"#0b141a",backgroundImage:"url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png')",backgroundBlendMode:"overlay",backgroundSize:"400px"},children:e.jsx("div",{className:"space-y-2",children:i.map(s=>{const l=s.sender?.id===p?.id;return e.jsx("div",{className:l?"flex justify-end":"flex justify-start",children:e.jsxs("div",{className:"relative max-w-[85%] sm:max-w-[65%] rounded-lg px-2 py-1.5 shadow-sm "+(l?"bg-[#005c4b] text-[#e9edef]":"bg-[#202c33] text-[#e9edef]"),children:[e.jsx("div",{className:"pr-12 text-[14.2px] leading-relaxed break-words",children:s.body}),e.jsxs("div",{className:"absolute bottom-1 right-1.5 flex items-center gap-1",children:[e.jsx("span",{className:"text-[11px] text-[#ffffff99]",children:s.created_at?new Date(s.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""}),l&&e.jsx(se,{className:"h-3 w-3 text-[#53bdeb]"})]})]})},s.id)})})}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 bg-[#202c33] px-2 sm:px-4 py-2 flex-shrink-0 min-h-[62px]",children:[e.jsx(ce,{className:"h-6 w-6 cursor-pointer text-[#8696a0] hover:text-white hidden sm:block"}),e.jsx(I,{className:"h-6 w-6 cursor-pointer text-[#8696a0] hover:text-white"}),e.jsxs("form",{onSubmit:T,className:"flex flex-1 items-center gap-2 sm:gap-4",children:[e.jsx("input",{value:r.data.body,onChange:s=>r.setData("body",s.target.value),placeholder:"Type a message",className:"w-full rounded-lg border-none bg-[#2a3942] py-2 px-4 text-sm text-[#d1d7db] placeholder-[#8696a0] focus:ring-0"}),r.data.body.trim()?e.jsx("button",{type:"submit",disabled:r.processing,className:"p-2 bg-[#00a884] rounded-full text-white hover:bg-[#008f6a] transition-colors",children:e.jsx(J,{className:"h-5 w-5"})}):e.jsx(re,{className:"h-6 w-6 text-[#8696a0] hover:text-white cursor-pointer"})]})]})]}):e.jsx("div",{className:"flex h-full flex-col items-center justify-center bg-[#222e35] text-center px-6",children:e.jsxs("div",{className:"max-w-md space-y-4",children:[e.jsx("div",{className:"mx-auto flex h-24 w-24 items-center justify-center rounded-full bg-[#202c33]",children:e.jsx(B,{className:"h-12 w-12 text-[#8696a0]"})}),e.jsx("h1",{className:"text-3xl font-light text-[#e9edef]",children:"WhatsApp Web"}),e.jsxs("p",{className:"text-sm text-[#8696a0] leading-relaxed",children:["Send and receive messages without keeping your phone online.",e.jsx("br",{}),"Use WhatsApp on up to 4 linked devices and 1 phone at the same time."]}),e.jsxs("div",{className:"pt-10 text-xs text-[#667781] flex items-center justify-center gap-1",children:[e.jsx(K,{className:"h-3 w-3"})," End-to-end encrypted"]})]})})})]}),e.jsx(R,{show:D,onClose:()=>m(!1),maxWidth:"md",children:e.jsxs("div",{className:"bg-[#202c33] text-[#e9edef] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-[#222d34] px-6 py-4",children:[e.jsx("h3",{className:"text-lg font-bold",children:"New Chat"}),e.jsx(O,{className:"h-6 w-6 cursor-pointer text-[#8696a0] hover:text-white",onClick:()=>m(!1)})]}),e.jsxs("div",{className:"flex border-b border-[#222d34]",children:[e.jsxs("button",{onClick:()=>w("individual"),className:`flex flex-1 items-center justify-center gap-2 py-4 text-sm font-bold transition-colors ${b==="individual"?"border-b-4 border-[#00a884] text-[#00a884]":"text-[#8696a0] hover:bg-[#2a3942]"}`,children:[e.jsx(Q,{className:"h-4 w-4"}),"Individual"]}),e.jsxs("button",{onClick:()=>w("group"),className:`flex flex-1 items-center justify-center gap-2 py-4 text-sm font-bold transition-colors ${b==="group"?"border-b-4 border-[#00a884] text-[#00a884]":"text-[#8696a0] hover:bg-[#2a3942]"}`,children:[e.jsx(ie,{className:"h-4 w-4"}),"Group"]})]}),e.jsx("div",{className:"p-6",children:b==="individual"?e.jsxs("form",{onSubmit:F,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(v,{htmlFor:"membership_number",value:"Enter Member Number",className:"text-[#8696a0] mb-2"}),e.jsxs("div",{className:"relative",children:[e.jsx(j,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-[#8696a0]"}),e.jsx(L,{id:"membership_number",className:"block w-full pl-10 bg-[#2a3942] border-none text-white focus:ring-1 focus:ring-[#00a884]",value:n.data.membership_number,onChange:s=>n.setData("membership_number",s.target.value),placeholder:"e.g. PP-12345",required:!0})]}),e.jsx(V,{message:n.errors.membership_number,className:"mt-2"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(M,{className:"bg-[#00a884] hover:bg-[#008f6a]",disabled:n.processing,children:"Start Chat"})})]}):e.jsxs("form",{onSubmit:P,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(v,{htmlFor:"group_name",value:"Group Name",className:"text-[#8696a0] mb-2"}),e.jsx(L,{id:"group_name",className:"block w-full bg-[#2a3942] border-none text-white focus:ring-1 focus:ring-[#00a884]",value:c.data.name,onChange:s=>c.setData("name",s.target.value),placeholder:"Enter group name",required:!0})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"group_desc",value:"Description (Optional)",className:"text-[#8696a0] mb-2"}),e.jsx("textarea",{id:"group_desc",className:"block w-full rounded-md border-none bg-[#2a3942] text-white focus:ring-1 focus:ring-[#00a884] resize-none h-24 text-sm",value:c.data.description,onChange:s=>c.setData("description",s.target.value),placeholder:"What's this group about?"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(M,{className:"bg-[#00a884] hover:bg-[#008f6a]",disabled:c.processing,children:"Create Group"})})]})})]})}),e.jsx("style",{children:`
                .custom-scrollbar::-webkit-scrollbar {
                    width: 6px;
                }
                .custom-scrollbar::-webkit-scrollbar-track {
                    background: transparent;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb {
                    background: #374045;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover {
                    background: #4a5559;
                }
            `})]})}export{Ce as default};
